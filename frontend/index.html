<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ArisuTalk</title>
  <!-- Temporary transparent icon to prevent 404 errors -->
  <link rel="icon" href="/icon_192.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/css/animations.css" />
</head>

<body class="bg-gray-950 text-white">
  <div id="app" class="relative flex overflow-hidden">
    <!-- Sidebar -->
    <aside id="sidebar"
      class="fixed inset-y-0 left-0 z-30 flex w-full flex-col bg-gray-900 transition-all duration-300 ease-in-out md:relative md:w-80 md:border-r md:border-gray-800">
      <button id="desktop-sidebar-toggle"
        class="absolute top-1/2 -translate-y-1/2 -right-4 h-8 w-8 items-center justify-center rounded-full border border-gray-600 bg-gray-700 transition-colors hover:bg-gray-600 md:flex z-20"></button>

      <div id="sidebar-content" class="flex h-full flex-col overflow-hidden"></div>
    </aside>

    <div id="page-transition-container" class="flex-1 relative">
      <!-- Character List Page (for Mobile) -->
      <div id="character-list-page-container" class="w-full h-full absolute top-0 left-0 flex-col bg-gray-950"></div>

      <!-- Main Chat Area -->
      <main id="main-chat" class="w-full h-full absolute top-0 left-0 flex flex-col bg-gray-950"></main>

      <!-- Settings Page (for Mobile) -->
      <div id="settings-page-container" class="w-full h-full absolute top-0 left-0 flex-col bg-gray-950"></div>

      <!-- AI Settings Page (for Mobile) -->
      <div id="ai-settings-page-container" class="w-full h-full absolute top-0 left-0 flex-col bg-gray-950"></div>

      <!-- Scale Settings Page (for Mobile) -->
      <div id="scale-settings-page-container" class="w-full h-full absolute top-0 left-0 flex-col bg-gray-950"></div>

      <!-- NAI Settings Page (for Mobile) -->
      <div id="nai-settings-container" class="w-full h-full absolute top-0 left-0 flex-col bg-gray-950"></div>
    </div>

    <!-- Sidebar Backdrop for Mobile -->
    <div id="sidebar-backdrop" class="fixed inset-0 z-20 hidden bg-black/50 md:hidden"></div>

    <!-- Modals (Rendered by JS) -->
    <div id="modal-container"></div>
    <div id="confirmation-modal-container"></div>

    <!-- Persistent file input moved outside of the re-rendering main-chat area -->
    <input type="file" id="image-upload-input" class="hidden" accept="image/*" />
    <input type="file" id="restore-file-input" class="hidden" accept="application/json" />
    <input type="file" id="restore-prompts-input" class="hidden" accept="application/json" />
  </div>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>
  <script>
    lucide.createIcons();
  </script>

  <script type="module" src="src/utils/debug-utils.ts"></script>
  <script type="module">
    import { initializeDebugUtility } from './src/utils/debug-utils.ts';
    import { dumpLocalStorageToJson, dumpIndexedDBToJson } from './src/utils/dev-tools.ts';

    initializeDebugUtility();

    // Expose dev tools globally for easy access in console
    if (import.meta.env.DEV) {
      window.__dev__ = {
        dumpLocalStorage: dumpLocalStorageToJson,
        dumpIndexedDB: dumpIndexedDBToJson,
      };
      console.log("Dev tools (__dev__.dumpLocalStorage(), __dev__.dumpIndexedDB()) are available in the console.");
    }
  </script>
  <script type="module" src="src/index.js"></script>
  
</body>

</html>