/* DO NOT DELETE THIS! THIS IS REQUIRED FOR TAILWIND V4. */
@import "tailwindcss";

/* 폰트 크기 변수 적용 */
html {
  font-size: calc(var(--font-scale, 1) * 14px);
}

.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* 스크롤바 숨기기 */
textarea,
.overflow-y-auto {
  scrollbar-width: none;
}

textarea::-webkit-scrollbar,
.overflow-y-auto::-webkit-scrollbar {
  display: none;
}

/* 단어 단위 줄바꿈 */
.break-words {
  overflow-wrap: break-word;
  word-break: break-word;
}

/* 모달 배경 */
.modal-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: oklch(0% 0 0 / 0.7);
  z-index: 40;
  backdrop-filter: blur(4px);
  transition: backdrop-filter 0.3s ease-out;
}

/* 모달 컨테이너 */
.modal-container {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 50;
  padding: 1rem;
}

/* 모달 */
.modal {
  background-color: oklch(33.26% 0.024 257.3); /* bg-gray-800 */
  border-radius: 0.75rem;
  box-shadow: 0 25px 50px -12px oklch(0% 0 0 / 0.25);
  max-width: 95%;
  width: 100%;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
}

/* 메시지 그룹 스타일 */
.message-content-wrapper {
  display: flex;
  flex-direction: column;
}

/* Floating Input Area Styles */
#input-area-wrapper #new-message-input {
  background-color: oklch(34.08% 0.021 258.41 / 0.7);
  border: 1px solid oklch(100% 0 0 / 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  box-shadow: 0 0 25px 5px oklch(59.37% 0.103 264.25 / 0.1);
}

#input-area-wrapper #open-input-options-btn,
#input-area-wrapper #sticker-btn {
  background-color: oklch(34.08% 0.021 258.41 / 0.7);
  border: 1px solid oklch(100% 0 0 / 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  box-shadow: 0 0 25px 5px oklch(59.37% 0.103 264.25 / 0.1);
}

#input-area-wrapper #send-message-btn {
  background-color: oklch(62.75% 0.19 256.25 / 0.7);
  border: 1px solid oklch(100% 0 0 / 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  box-shadow: 0 0 25px 5px oklch(59.37% 0.103 264.25 / 0.1);
}

.floating-panel {
  background-color: oklch(34.08% 0.021 258.41 / 0.7);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid oklch(100% 0 0 / 0.08);
  box-shadow: 0 0 25px 5px oklch(59.37% 0.103 264.25 / 0.1);
}

#main-chat {
  position: relative;
}

#input-area-wrapper {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 10;
  padding-bottom: 1rem;
}

#input-area-wrapper::before {
  content: "";
  position: absolute;
  top: -200px;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: -1;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  mask-image: linear-gradient(to top, black 20%, transparent 100%);
  -webkit-mask-image: linear-gradient(to top, black 20%, transparent 100%);
  pointer-events: none;
}

#input-area-wrapper.transitions-enabled::before {
  transition: all 0.3s ease-in-out;
}

#input-area-wrapper.scrolled-to-bottom::before {
  display: none;
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
}

#new-message-input {
  transition: all 0.2s ease-in-out;
}

#new-message-input:focus {
  box-shadow: 0 0 0 2px oklch(62.75% 0.19 256.25 / 0.5);
}

/* --- Mobile First Layout --- */

#app {
  display: flex;
  flex-direction: row;
}

#sidebar {
  display: none; /* Hidden by default on mobile */
}

#character-list-page-container,
#main-chat {
  width: 100%;
  /* height: 100vh; */ /* Removed to allow flex to control height */
  display: flex; /* Use flex for children */
  flex-direction: column;
}

.hidden {
  display: none !important;
}

/* --- Desktop Layout --- */
@media (min-width: 768px) {
  #app {
    flex-direction: row;
  }

  #sidebar {
    display: flex; /* Show sidebar on desktop */
    width: 400px; /* Or your preferred width */
    flex-shrink: 0;
  }

  #character-list-page-container {
    display: none; /* Hide character list page on desktop */
  }

  #main-chat {
    flex: 1;
    display: flex; /* Ensure it's a flex container */
  }
}

/* Tree-like structure for chat room list */
.character-group {
  position: relative;
}

.character-group .chat-room-list {
  position: relative;
}

.character-group.is-expanded::before {
  content: "";
  position: absolute;
  left: var(--tree-trunk-left);
  top: var(--tree-connector-top);
  height: var(--tree-connector-height);
  width: 2px;
  background-color: oklch(45.31% 0.018 257.3);
  transition: height 0.2s ease-out;
}

.chat-room-list-item-wrapper {
  position: relative;
  padding-left: calc(var(--tree-trunk-left) + 15px);
}

.chat-room-list-item-wrapper::before {
  content: "";
  position: absolute;
  top: 0;
  left: calc(var(--tree-trunk-left) - 7px);
  width: 12px;
  height: 50%;
  border: 2px solid oklch(45.31% 0.018 257.3);
  border-color: transparent transparent oklch(45.31% 0.018 257.3) oklch(45.31% 0.018 257.3);
  border-bottom-left-radius: 8px;
}

@media (min-width: 768px) {
  #sidebar {
    transition: width 0.3s ease-in-out;
  }

  .sidebar-collapsed #sidebar {
    width: 0;
  }
}

button > svg {
  pointer-events: none;
}

.character-list-scrollbar {
  scrollbar-width: thin !important;
  scrollbar-color: oklch(100% 0 0 / 0.5) transparent !important;
}

.character-list-scrollbar::-webkit-scrollbar {
  display: block !important;
  -webkit-appearance: none;
  width: 7px;
}

.character-list-scrollbar::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: oklch(100% 0 0 / 0.5);
  box-shadow: 0 0 1px oklch(100% 0 0 / 0.5);
}

.message-bubble-me {
  background-color: oklch(58.3% 0.213 262.26 / 0.7);
}

.message-bubble-them {
  background-color: oklch(38.56% 0.019 257.3 / 0.7);
}

/* Added for long-press ripple effect */
.character-list-item {
  position: relative;
  overflow: hidden;
}

/* Toggle Switch CSS */
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: oklch(82.25% 0 0);
  -webkit-transition: 0.4s;
  transition: 0.4s;
}

.toggle-slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: oklch(100% 0 0);
  -webkit-transition: 0.4s;
  transition: 0.4s;
}

input:checked + .toggle-slider {
  background-color: oklch(67.85% 0.143 148.6);
}

input:focus + .toggle-slider {
  box-shadow: 0 0 1px oklch(69.55% 0.198 252.3);
}

input:checked + .toggle-slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}

/* Rounded sliders */
.toggle-slider.round {
  border-radius: 34px;
}

.toggle-slider.round:before {
  border-radius: 50%;
}

/* 커스텀 애니메이션 */
@keyframes slideUp {
  0% {
    opacity: 0;
    transform: translateY(15px);
    scale: 0.95;
  }

  100% {
    opacity: 1;
    transform: translateY(0);
    scale: 1;
  }
}

.animate-slideUp {
  animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}

.animate-fadeIn {
  animation: fadeIn 0.3s ease-in-out;
}

@keyframes fab-menu-in {
  from {
    transform: scale(0.95) translateY(10px);
    opacity: 0;
  }
  to {
    transform: scale(1) translateY(0);
    opacity: 1;
  }
}

.animate-fab-menu-in {
  animation: fab-menu-in 0.2s ease-out forwards;
}

@keyframes slide-down {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}

.animate-slide-down {
  animation: slide-down 0.3s ease-out forwards;
}

@keyframes slide-down-fast {
  from {
    transform: translateY(-20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.animate-slide-down-fast {
  animation: slide-down-fast 0.3s ease-out forwards;
}

.height-transition {
  transition: max-height 0.7s cubic-bezier(0.4, 0, 0.2, 1);
}

/* 로딩 스피너 */
@keyframes pulse {
  50% {
    opacity: 0.5;
  }
}

.animate-pulse {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* Added for mobile edit mode header */
@keyframes fadeInHeader {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes fadeOutHeader {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

.animate-fade-in {
  animation: fadeInHeader 0.3s ease-out forwards;
}

.animate-fade-out {
  animation: fadeOutHeader 0.3s ease-out forwards;
}

/* Added for long-press ripple effect */
.ripple {
  position: absolute;
  border-radius: 50%;
  background-color: oklch(100% 0 0 / 0.3);
  transform: scale(0);
  animation: ripple 0.6s ease-out;
  pointer-events: none;
  width: 100px; /* Set a fixed size */
  height: 100px; /* Set a fixed size */
  margin-top: -50px; /* Adjust for size */
  margin-left: -50px; /* Adjust for size */
}

@keyframes ripple {
  to {
    transform: scale(4);
    opacity: 0;
  }
}

/* Added for modal close animation */
@keyframes modalFadeOut {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.95);
  }
}

.animate-modal-fade-out {
  animation: modalFadeOut 0.2s ease-in-out forwards;
}

@keyframes backdropFadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

.animate-backdrop-fade-out {
  animation: backdropFadeOut 0.2s ease-in-out forwards;
}